-- 코드를 입력하세요


WITH RECURSIVE A AS (
    SELECT 0 AS HOUR
    UNION ALL
    SELECT 1 + A.HOUR
    FROM A
    WHERE A.HOUR < 23 )

# SELECT HOUR(DATETIME), COUNT(HOUR(DATETIME))
# FROM ANIMAL_OUTS
# GROUP BY HOUR(DATETIME)
# ORDER BY HOUR(DATETIME)

# SELECT HOUR(DATETIME)
# FROM ANIMAL_OUTS

SELECT
A.HOUR, IFNULL(COUNT(HOUR(AO.DATETIME)), 0)
FROM A
LEFT OUTER JOIN ANIMAL_OUTS AO
ON A.HOUR = HOUR(AO.DATETIME)
GROUP BY A.HOUR


